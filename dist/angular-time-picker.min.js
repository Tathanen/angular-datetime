/*! angular-datetime Copyright Vokal 2015 */
angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter",function(a,b){"use strict";return{restrict:"A",scope:{},require:"ngModel",link:function(c,d,e,f){f.$parsers.unshift(function(a){var c=new Date("1/1/1990 "+a);return f.$setValidity("time",!isNaN(c.getTime())),"string"===e.pickerType?b("date")(c,e.timePicker||"h:mm a"):c}),f.$formatters.push(function(a){var c,d=a;return d&&("function"!=typeof d.getTime&&(d=new Date("1/1/1990 "+d)),c=!isNaN(d.getTime()),f.$setValidity("time",c)),c?b("date")(d,e.timePicker||"h:mm a"):a}),c.times=[],c.showTimepicker=!1;for(var g,h,i,j=e.pickerInterval?parseInt(e.pickerInterval,10):60,k=0;24>k;k++)for(var l=0;60>l;l+=j)h=10>l?"0"+l:l,g=new Date("1/1/1990 "+k+":"+h),i=b("date")(g,e.timePicker||"h:mm a"),c.times.push(i);c.applyTime=function(a){f.$setViewValue(a),f.$render(),c.showTimepicker=!1};var m=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time }}</li></ol>');a(m)(c),d.after(m),d.on("click",function(){c.$apply(function(){c.showTimepicker=!0})}),d.on("keydown paste",function(){c.$apply(function(){c.showTimepicker=!1})}),angular.element(document.getElementsByTagName("html")[0]).on("mousedown touchstart",function(a){if(c.showTimepicker){for(var b=angular.element(a.target).scope();b;b=b.$parent)if(c.$id===b.$id)return;c.$apply(function(){c.showTimepicker=!1})}})}}}]);